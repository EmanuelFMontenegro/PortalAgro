<div class="form-container">
  <h2>{{ titulo }}</h2>
  <form class="form" (ngSubmit)="updateFormData()">
    <div class="form-group" *ngFor="let item of dataForm">
      <label class="field-label" [for]="item.ngModel">{{ item.placeholder }}</label>

      <!-- Campo de texto o contraseña -->
      <input *ngIf="item.type === 'text' || item.type === 'password'" [type]="item.type"
        [placeholder]="item.placeholder" [(ngModel)]="formData[item.ngModel]" [name]="item.name"
        [readonly]="item.readonly || false" [id]="item.ngModel" class="input" autocomplete="new-password"
        (change)="updateFormData()">

      <!-- Campo de archivo IMAGEN -->
      <div class="botones-imagen">
        <div *ngIf="item.type === 'file'">
          <label class="custom-file-upload">
            <input type="file" (change)="onFileChange($event, item.ngModel)" [name]="item.name" [id]="item.ngModel"
              accept="image/*">
            Subir Imagen
          </label>
          <mat-card *ngIf="formData[item.ngModel]" class="image-upload-card">
            <mat-card-content>
              <img [src]="formData[item.ngModel]" alt="Imagen cargada" class="uploaded-image" />
            </mat-card-content>
          </mat-card>
        </div>
      </div>



      <!-- Campo de texto multilínea -->
      <textarea *ngIf="item.type === 'textarea'" [placeholder]="item.placeholder" [(ngModel)]="formData[item.ngModel]"
        [name]="item.name" [readonly]="item.readonly || false" [id]="item.ngModel" class="input"
        (change)="updateFormData()"></textarea>

      <!-- Campo de selección usando mat-select -->
      <ng-container *ngIf="item.type === 'select'">
        <mat-select placeholder="Seleccione departamento" [(ngModel)]="formData[item.ngModel]" [name]="item.name"
          [id]="item.ngModel" (selectionChange)="updateFormData()" [multiple]="item.multiple || false"
          class="full-width">
          <mat-option *ngFor="let option of item.options" [value]="option.value">
            {{ option.text }}
          </mat-option>
        </mat-select>
        <mat-chip-grid #chipGrid>
          <mat-chip-row *ngFor="let department of formData[item.ngModel]"
            (removed)="removeDepartment(department, item.ngModel)">
            {{ getDescripcionDepartament(department, item.options) }}
            <button matChipRemove [attr.aria-label]="'remove ' + department">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
          <input [matChipInputFor]="chipGrid" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            (matChipInputTokenEnd)="addDepartment($event, item.ngModel)" />
        </mat-chip-grid>
      </ng-container>

      <!-- Campo de checkbox -->
      <input *ngIf="item.type === 'checkbox'" type="checkbox" [(ngModel)]="formData[item.ngModel]" [name]="item.name"
        [readonly]="item.readonly || false" [id]="item.ngModel" class="input" (change)="updateFormData()">
    </div>
  </form>
</div>
